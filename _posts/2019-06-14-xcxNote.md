---
layout: post
title: "微信小程序开发笔记"
date: 2018-06-14
description: "微信小程序开发笔记"
tag: 小程序
---   

### 使用mpvue开发小程序---Vuex（store）的支持

mpvue提供了vue的语法编译为小程序的能力，但是还是有些局限，不过能做到跟vue差不多已经很不错了。

我在项目中按照vue初始化 store 的时候，本以为能像vue里正常使用vuex的一些功能，发现报错 `TypeError: Cannot read property 'state' of undefined`，一下子懵逼了，在pages的页面里打印 `this`对象，发现并没 `$store`属性，也就是说mpvue对store并没有初始化成功，苦瓜脸...

百度中... 不负有心人~~~

原因如下：


mpvue使用上，vuex和以往类似，不同的是，小程序以多页形式渲染，故**每个页面**都需要创建vue实例并引入相应的store模块，入口配置大概如下：

    import Vue from 'vue';
    import Vuex from 'vuex';
    import store from './store';
    import App from './index';
    
    Vue.use(Vuex);
    
    const app = new Vue({
        ...App,
        store
    });
    
    app.$mount();

***注意：是每个页面都要初始化渲染...*** （很麻烦的感觉）

亲测可用，终于可以起飞了~~~~~~~

### 小程序分享页面

分享的页面如果需要参数就一定要传参，并且path要写app.json中所配置的绝对路径

在做小程序分享这部分的时候，一开始经常会遇到页面不存在的情况，后面才发觉一般遇到这种情况都是因为使用 onShareAppMessage() 方法时path没有写对，这时只需要将app.json中配置该页面的路径直接复制过来就好啦！

    // app.json
    {
    "pages":[
        "pages/test/test"    //  ①
    ]
    }
    // test.js
    onShareAppMessage: function () {
        return {
        title: '自定义转发标题',
        path: 'pages/test/test?id=123',   //此处所写路径与 ① 处相同，若页面需传参数，记得把参数带上
        }
    },

